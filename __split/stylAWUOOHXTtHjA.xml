<?xml version="1.0"?>
<stylesheet id="stylAWUOOHXTtHjA" lang="any" name="transform" show-in="main" webpalschematype="wpAppStylesheet"><![CDATA[
<!-- (c) 2001-present All Copyrights Palomino System Innovations Inc.
Illegal reproduction and disclosure will be prosecuted  -->

<xsl:stylesheet
version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:wp="http://www.palominosys.com/wp"
xmlns:php="http://php.net/xsl"
xmlns:date="http://exslt.org/dates-and-times"
xmlns:exsl="http://exslt.org/common"
extension-element-prefixes="exsl"
>
  
  <!-- ========================================================================================= -->
  <!-- =================================== newslist templates ================================== -->
  <!-- ========================================================================================= -->
  
  <xsl:strip-space elements="*"/>
  
  <xsl:template match="text()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>
  
  <xsl:template match="*">
    <xsl:copy>
      <xsl:attribute name="path">
        <xsl:call-template name="genPath"/>
      </xsl:attribute>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>    
  </xsl:template>
  
  <xsl:template name="product-store-itemcount">
    <xsl:text>{{ Session::get('cart_itemcount')?Session::get('cart_itemcount'):0 }}</xsl:text>
      </xsl:template>
  
  <xsl:template name="genPath">
    <xsl:param name="prevPath"/>
    <xsl:variable name="currPath" select="concat('/',name(),'[', count(preceding-sibling::*[name() = name(current())])+1,']',$prevPath)"/>
    <xsl:for-each select="parent::*">
      <xsl:call-template name="genPath">
        <xsl:with-param name="prevPath" select="$currPath"/>
      </xsl:call-template>
    </xsl:for-each>
    <xsl:if test="not(parent::*)">
      <xsl:value-of select="$currPath"/>      
    </xsl:if>
  </xsl:template>
  
  
  <xsl:template match="bnd-products">
<!--     <xsl:param name="current-path"/> -->
    
<!--      <xsl:variable name="path" select="concat($current-path,'/',./@name)" /> -->
    
<!--     <xsl:variable name="chapter_id" select="../@id"/>
    <xsl:variable name="path">
      <xsl:call-template name="create_xpath_to_node">
        <xsl:with-param name="node_id" select="$chapter_id"/>
        <xsl:with-param name="web_root" select="//pages"/>
      </xsl:call-template>
    </xsl:variable> -->
    
    <div class="products">
      <xsl:for-each select="productSection">
        <div class="productSection">
          <xsl:apply-templates select="." mode="list"/>
        </div>
      </xsl:for-each>
    </div>
  </xsl:template>
  
  
  
  
  
  <xsl:template match="bnd-products/productSection" mode="list">
    <xsl:param name="path"/>
    
    <h1><xsl:value-of select="sectionTitle"/></h1>
    <a href="{$path}">View <xsl:value-of select="sectionTitle"/> Catalogue</a>
  </xsl:template>
  
  <xsl:template match="bnd-products/productSection"> 
    <xsl:param name="path"/>
    
    <div class="productSection">
      <h1><xsl:value-of select="sectionTitle"/></h1>
      <div><xsl:apply-templates select="description"/></div>
      <div class="productCategory">
        <ul>
          <xsl:for-each select="productCategory">
            <xsl:apply-templates select="." mode="list"/>
          </xsl:for-each>
        </ul>
      </div>
    </div>
  </xsl:template>
  
  
  <xsl:template match="bnd-products/productSection/productCategory" mode="list">
    <xsl:param name="path"/>
    <li>
      <a href="{$path}"><xsl:value-of select="categoryTitle"/></a>
    </li>
  </xsl:template>
  
</xsl:stylesheet>]]></stylesheet>
